-- Create the 'company' table
CREATE TABLE company (
    Id INT PRIMARY KEY IDENTITY,
    Name NVARCHAR(255) NOT NULL
);

-- Create the 'car' table
CREATE TABLE car (
    Id INT PRIMARY KEY IDENTITY,
    Registration_number NVARCHAR(255) NOT NULL,
    Company_id INT,
    FOREIGN KEY (Company_id) REFERENCES company(Id)
);

-- Create the 'department' table
CREATE TABLE department (
    Id INT PRIMARY KEY IDENTITY,
    Name NVARCHAR(255) NOT NULL,
    Company_id INT,
    FOREIGN KEY (Company_id) REFERENCES company(Id)
);

-- Create the 'address' table
CREATE TABLE address (
    Id INT PRIMARY KEY IDENTITY,
    House_number NVARCHAR(255),
    Street NVARCHAR(255),
    Zip_code NVARCHAR(255)
);

-- Create the 'employee' table
CREATE TABLE employee (
    Id INT PRIMARY KEY IDENTITY,
    Name NVARCHAR(255) NOT NULL,
    Surname NVARCHAR(255) NOT NULL,
    Address_id INT,
    Department_id INT,
    FOREIGN KEY (Address_id) REFERENCES address(Id),
    FOREIGN KEY (Department_id) REFERENCES department(Id)
);

CREATE TABLE USER_ (
    ID INT PRIMARY KEY,
    USER_NAME NVARCHAR(255) NOT NULL,
    PASSWORD NVARCHAR(255) NOT NULL,
    ACCOUNT_EXPIRED BIT NOT NULL,
    ACCOUNT_LOCKED BIT NOT NULL,
    CREDENTIALS_EXPIRED BIT NOT NULL,
    ENABLED BIT NOT NULL
);

CREATE TABLE AUTHORITY (
    ID INT PRIMARY KEY,
    NAME NVARCHAR(255) NOT NULL
);

CREATE TABLE USERS_AUTHORITIES (
	USER_ID INT,
	AUTHORITY_ID INT
);

CREATE TABLE OAUTH_CLIENT_DETAILS (
    client_id NVARCHAR(256) NOT NULL,
    resource_ids NVARCHAR(256),
    client_secret NVARCHAR(256),
    scope NVARCHAR(256),
    authorized_grant_types NVARCHAR(256),
    web_server_redirect_uri NVARCHAR(256),
    authorities NVARCHAR(256),
    access_token_validity INT,
    refresh_token_validity INT,
    additional_information NVARCHAR(256),
    autoapprove NVARCHAR(256),
    PRIMARY KEY (client_id)
);

CREATE TABLE oauth_client_token (
    token_id VARCHAR(255) PRIMARY KEY,
    token VARBINARY(MAX),
    authentication_id VARCHAR(255),
    user_name VARCHAR(255),
    client_id VARCHAR(255)
);

CREATE TABLE oauth_access_token (
    token_id VARCHAR(255) PRIMARY KEY,
    token VARBINARY(MAX),
    authentication_id VARCHAR(255),
    user_name VARCHAR(255),
    client_id VARCHAR(255),
    authentication VARBINARY(MAX),
    refresh_token VARCHAR(255)
);

CREATE TABLE oauth_refresh_token (
    token_id VARCHAR(255) PRIMARY KEY,
    token VARBINARY(MAX),
    authentication VARBINARY(MAX)
);

CREATE TABLE oauth_code (
    code VARCHAR(255) PRIMARY KEY,
    authentication VARBINARY(MAX)
);

CREATE TABLE oauth_approvals (
    expiresAt DATETIME,
    status VARCHAR(255),
    lastModifiedAt DATETIME,
    userId VARCHAR(255),
    clientId VARCHAR(255),
    scope VARCHAR(255)
);

INSERT INTO OAUTH_CLIENT_DETAILS(CLIENT_ID, RESOURCE_IDS, CLIENT_SECRET, SCOPE, AUTHORIZED_GRANT_TYPES, AUTHORITIES, ACCESS_TOKEN_VALIDITY, REFRESH_TOKEN_VALIDITY)
 VALUES ('spring-security-oauth2-read-client', 'resource-server-rest-api',
 /*spring-security-oauth2-read-client-password1234*/'$2a$04$WGq2P9egiOYoOFemBRfsiO9qTcyJtNRnPKNBl5tokP7IP.eZn93km',
 'read', 'password,authorization_code,refresh_token,implicit', 'USER', 10800, 2592000);

INSERT INTO OAUTH_CLIENT_DETAILS(CLIENT_ID, RESOURCE_IDS, CLIENT_SECRET, SCOPE, AUTHORIZED_GRANT_TYPES, AUTHORITIES, ACCESS_TOKEN_VALIDITY, REFRESH_TOKEN_VALIDITY)
 VALUES ('spring-security-oauth2-read-write-client', 'resource-server-rest-api',
 /*spring-security-oauth2-read-write-client-password1234*/'$2a$04$soeOR.QFmClXeFIrhJVLWOQxfHjsJLSpWrU1iGxcMGdu.a5hvfY4W',
 'read,write', 'password,authorization_code,refresh_token,implicit', 'USER', 10800, 2592000);

INSERT INTO AUTHORITY(ID, NAME) VALUES (1, 'COMPANY_CREATE');
INSERT INTO AUTHORITY(ID, NAME) VALUES (2, 'COMPANY_READ');
INSERT INTO AUTHORITY(ID, NAME) VALUES (3, 'COMPANY_UPDATE');
INSERT INTO AUTHORITY(ID, NAME) VALUES (4, 'COMPANY_DELETE');

INSERT INTO AUTHORITY(ID, NAME) VALUES (5, 'DEPARTMENT_CREATE');
INSERT INTO AUTHORITY(ID, NAME) VALUES (6, 'DEPARTMENT_READ');
INSERT INTO AUTHORITY(ID, NAME) VALUES (7, 'DEPARTMENT_UPDATE');
INSERT INTO AUTHORITY(ID, NAME) VALUES (8, 'DEPARTMENT_DELETE');

INSERT INTO USER_(ID, USER_NAME, PASSWORD, ACCOUNT_EXPIRED, ACCOUNT_LOCKED, CREDENTIALS_EXPIRED, ENABLED)
  VALUES (1, 'admin', /*admin1234*/'$2a$08$qvrzQZ7jJ7oy2p/msL4M0.l83Cd0jNsX6AJUitbgRXGzge4j035ha', FALSE, FALSE, FALSE, TRUE);

INSERT INTO USER_(ID, USER_NAME, PASSWORD, ACCOUNT_EXPIRED, ACCOUNT_LOCKED, CREDENTIALS_EXPIRED, ENABLED)
  VALUES (2, 'reader', /*reader1234*/'$2a$08$dwYz8O.qtUXboGosJFsS4u19LHKW7aCQ0LXXuNlRfjjGKwj5NfKSe', FALSE, FALSE, FALSE, TRUE);

INSERT INTO USER_(ID, USER_NAME, PASSWORD, ACCOUNT_EXPIRED, ACCOUNT_LOCKED, CREDENTIALS_EXPIRED, ENABLED)
  VALUES (3, 'modifier', /*modifier1234*/'$2a$08$kPjzxewXRGNRiIuL4FtQH.mhMn7ZAFBYKB3ROz.J24IX8vDAcThsG', FALSE, FALSE, FALSE, TRUE);

INSERT INTO USER_(ID, USER_NAME, PASSWORD, ACCOUNT_EXPIRED, ACCOUNT_LOCKED, CREDENTIALS_EXPIRED, ENABLED)
  VALUES (4, 'reader2', /*reader1234*/'$2a$08$vVXqh6S8TqfHMs1SlNTu/.J25iUCrpGBpyGExA.9yI.IlDRadR6Ea', FALSE, FALSE, FALSE, TRUE);

INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 1);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 2);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 3);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 4);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 5);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 6);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 7);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 8);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (1, 9);

INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (2, 2);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (2, 6);

INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (3, 3);
INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (3, 7);

INSERT INTO USERS_AUTHORITIES(USER_ID, AUTHORITY_ID) VALUES (4, 9);